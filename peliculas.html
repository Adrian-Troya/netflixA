<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD Firebase</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        #movie-form {
            margin-bottom: 20px;
        }

        #movie-form input, #movie-form textarea, #movie-form button {
            display: block;
            margin: 10px 0;
        }

        #movies-list {
            margin-top: 20px;
        }

        .movie-item {
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>CRUD Firebase</h1>
    <div id="app">
        <form id="movie-form">
            <input type="text" id="id" placeholder="ID de la Película (solo para buscar)" required>
            <input type="text" id="titulo" placeholder="Título" required>
            <input type="text" id="director" placeholder="Director" required>
            <input type="number" id="año_estreno" placeholder="Año de Estreno" required>
            <input type="text" id="genero" placeholder="Género" required>
            <input type="number" id="duracion_minutos" placeholder="Duración en Minutos" required>
            <input type="text" id="idioma_original" placeholder="Idioma Original" required>
            <input type="text" id="pais_produccion" placeholder="País de Producción" required>
            <input type="number" step="0.1" id="calificacion_IMDB" placeholder="Calificación IMDb" required>
            <textarea id="sinopsis" placeholder="Sinopsis" required></textarea>
            <button type="button" id="add-btn">Agregar Película</button>
            <button type="button" id="update-btn">Actualizar Película</button>
            <button type="button" id="delete-btn">Eliminar Película</button>
            <button type="button" id="search-btn">Buscar Película</button>
        </form>
        <div id="movies-list"></div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
    <script>
        // Configurar Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Inicializar Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(app);

        // Referencia a la colección de películas
        const moviesCollection = db.collection('peliculas');

        // Función para agregar una película
        document.getElementById('add-btn').addEventListener('click', async () => {
            const movieData = {
                titulo: document.getElementById('titulo').value,
                director: document.getElementById('director').value,
                año_estreno: parseInt(document.getElementById('año_estreno').value),
                genero: document.getElementById('genero').value,
                duracion_minutos: parseInt(document.getElementById('duracion_minutos').value),
                idioma_original: document.getElementById('idioma_original').value,
                pais_produccion: document.getElementById('pais_produccion').value,
                calificacion_IMDB: parseFloat(document.getElementById('calificacion_IMDB').value),
                sinopsis: document.getElementById('sinopsis').value
            };

            await moviesCollection.add(movieData);
            document.getElementById('movie-form').reset();
        });

        // Función para actualizar una película
        document.getElementById('update-btn').addEventListener('click', async () => {
            const id = document.getElementById('id').value;
            if (id) {
                const movieData = {
                    titulo: document.getElementById('titulo').value,
                    director: document.getElementById('director').value,
                    año_estreno: parseInt(document.getElementById('año_estreno').value),
                    genero: document.getElementById('genero').value,
                    duracion_minutos: parseInt(document.getElementById('duracion_minutos').value),
                    idioma_original: document.getElementById('idioma_original').value,
                    pais_produccion: document.getElementById('pais_produccion').value,
                    calificacion_IMDB: parseFloat(document.getElementById('calificacion_IMDB').value),
                    sinopsis: document.getElementById('sinopsis').value
                };

                await moviesCollection.doc(id).set(movieData);
                document.getElementById('movie-form').reset();
            }
        });

        // Función para eliminar una película
        document.getElementById('delete-btn').addEventListener('click', async () => {
            const id = document.getElementById('id').value;
            if (id) {
                await moviesCollection.doc(id).delete();
                document.getElementById('movie-form').reset();
            }
        });

        // Función para buscar una película por ID y rellenar los campos del formulario
        document.getElementById('search-btn').addEventListener('click', async () => {
            const id = document.getElementById('id').value;
            if (id) {
                const doc = await moviesCollection.doc(id).get();
                if (doc.exists) {
                    const movie = doc.data();
                    document.getElementById('titulo').value = movie.titulo;
                    document.getElementById('director').value = movie.director;
                    document.getElementById('año_estreno').value = movie.año_estreno;
                    document.getElementById('genero').value = movie.genero;
                    document.getElementById('duracion_minutos').value = movie.duracion_minutos;
                    document.getElementById('idioma_original').value = movie.idioma_original;
                    document.getElementById('pais_produccion').value = movie.pais_produccion;
                    document.getElementById('calificacion_IMDB').value = movie.calificacion_IMDB;
                    document.getElementById('sinopsis').value = movie.sinopsis;
                } else {
                    alert("Película no encontrada");
                }
            }
        });

        // Leer y mostrar las películas
        const moviesList = document.getElementById('movies-list');
        moviesCollection.onSnapshot((snapshot) => {
            moviesList.innerHTML = '';
            snapshot.forEach((doc) => {
                const movie = doc.data();
                moviesList.innerHTML += `
                    <div class="movie-item">
                        <h3>${movie.titulo}</h3>
                        <p><strong>ID:</strong> ${doc.id}</p>
                        <p><strong>Director:</strong> ${movie.director}</p>
                        <p><strong>Año de Estreno:</strong> ${movie.año_estreno}</p>
                        <p><strong>Género:</strong> ${movie.genero}</p>
                        <p><strong>Duración:</strong> ${movie.duracion_minutos} minutos</p>
                        <p><strong>Idioma Original:</strong> ${movie.idioma_original}</p>
                        <p><strong>País de Producción:</strong> ${movie.pais_produccion}</p>
                        <p><strong>Calificación IMDb:</strong> ${movie.calificacion_IMDB}</p>
                        <p><strong>Sinopsis:</strong> ${movie.sinopsis}</p>
                    </div>
                `;
            });
        });
    </script>
</body>
</html>
