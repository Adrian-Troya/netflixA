<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD Firebase</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        #movie-form {
            margin-bottom: 20px;
        }

        #movie-form input, #movie-form textarea, #movie-form button {
            display: block;
            margin: 10px 0;
        }

        #movies-table {
            margin-top: 20px;
            width: 100%;
            border-collapse: collapse;
        }

        #movies-table th, #movies-table td {
            border: 1px solid #ccc;
            padding: 10px;
        }

        #movies-table th {
            background-color: #f4f4f4;
        }
    </style>
</head>
<body>
    <h1>CRUD Firebase</h1>
    <div id="app">
        <form id="movie-form">
            <input type="text" id="id" placeholder="ID de la Película (solo para buscar)">
            <input type="text" id="titulo" placeholder="Título" required>
            <input type="text" id="director" placeholder="Director" required>
            <input type="number" id="año_estreno" placeholder="Año de Estreno" required>
            <input type="text" id="genero" placeholder="Género" required>
            <input type="number" id="duracion_minutos" placeholder="Duración en Minutos" required>
            <input type="text" id="idioma_original" placeholder="Idioma Original" required>
            <input type="text" id="pais_produccion" placeholder="País de Producción" required>
            <input type="number" step="0.1" id="calificacion_IMDB" placeholder="Calificación IMDb" required>
            <textarea id="sinopsis" placeholder="Sinopsis" required></textarea>
            <button type="button" id="add-btn">Agregar Película</button>
            <button type="button" id="update-btn">Actualizar Película</button>
            <button type="button" id="delete-btn">Eliminar Película</button>
            <button type="button" id="search-btn">Buscar Película</button>
        </form>
        <table id="movies-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Título</th>
                    <th>Director</th>
                    <th>Año</th>
                    <th>Género</th>
                    <th>Duración</th>
                    <th>Idioma</th>
                    <th>País</th>
                    <th>Calificación</th>
                    <th>Sinopsis</th>
                </tr>
            </thead>
            <tbody id="movies-list"></tbody>
        </table>
    </div>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
    <script>
        // Configurar Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Inicializar Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(app);

        // Referencia a la colección de películas
        const moviesCollection = db.collection('peliculas');

        // Función para agregar una película
        document.getElementById('add-btn').addEventListener('click', async () => {
            const movieData = {
                titulo: document.getElementById('titulo').value,
                director: document.getElementById('director').value,
                año_estreno: parseInt(document.getElementById('año_estreno').value),
                genero: document.getElementById('genero').value,
                duracion_minutos: parseInt(document.getElementById('duracion_minutos').value),
                idioma_original: document.getElementById('idioma_original').value,
                pais_produccion: document.getElementById('pais_produccion').value,
                calificacion_IMDB: parseFloat(document.getElementById('calificacion_IMDB').value),
                sinopsis: document.getElementById('sinopsis').value
            };

            await moviesCollection.add(movieData);
            document.getElementById('movie-form').reset();
            loadMovies();
        });

        // Función para actualizar una película
        document.getElementById('update-btn').addEventListener('click', async () => {
            const id = document.getElementById('id').value;
            if (id) {
                const movieData = {
                    titulo: document.getElementById('titulo').value,
                    director: document.getElementById('director').value,
                    año_estreno: parseInt(document.getElementById('año_estreno').value),
                    genero: document.getElementById('genero').value,
                    duracion_minutos: parseInt(document.getElementById('duracion_minutos').value),
                    idioma_original: document.getElementById('idioma_original').value,
                    pais_produccion: document.getElementById('pais_produccion').value,
                    calificacion_IMDB: parseFloat(document.getElementById('calificacion_IMDB').value),
                    sinopsis: document.getElementById('sinopsis').value
                };

                await moviesCollection.doc(id).set(movieData);
                document.getElementById('movie-form').reset();
                loadMovies();
            }
        });

        // Función para eliminar una película
        document.getElementById('delete-btn').addEventListener('click', async () => {
            const id = document.getElementById('id').value;
            if (id) {
                await moviesCollection.doc(id).delete();
                document.getElementById('movie-form').reset();
                loadMovies();
            }
        });

        // Función para buscar una película por ID y rellenar los campos del formulario
        document.getElementById('search-btn').addEventListener('click', async () => {
            const id = document.getElementById('id').value;
            if (id) {
                const doc = await moviesCollection.doc(id).get();
                if (doc.exists) {
                    const movie = doc.data();
                    document.getElementById('titulo').value = movie.titulo;
                    document.getElementById('director').value = movie.director;
                    document.getElementById('año_estreno').value = movie.año_estreno;
                    document.getElementById('genero').value = movie.genero;
                    document.getElementById('duracion_minutos').value = movie.duracion_minutos;
                    document.getElementById('idioma_original').value = movie.idioma_original;
                    document.getElementById('pais_produccion').value = movie.pais_produccion;
                    document.getElementById('calificacion_IMDB').value = movie.calificacion_IMDB;
                    document.getElementById('sinopsis').value = movie.sinopsis;
                } else {
                    alert("Película no encontrada");
                }
            }
        });

        // Leer y mostrar las películas
        const loadMovies = () => {
            moviesCollection.onSnapshot((snapshot) => {
                const moviesList = document.getElementById('movies-list');
                moviesList.innerHTML = '';
                snapshot.forEach((doc) => {
                    const movie = doc.data();
                    moviesList.innerHTML += `
                        <tr>
                            <td>${doc.id}</td>
                            <td>${movie.titulo}</td>
                            <td>${movie.director}</td>
                            <td>${movie.año_estreno}</td>
                            <td>${movie.genero}</td>
                            <td>${movie.duracion_minutos}</td>
                            <td>${movie.idioma_original}</td>
                            <td>${movie.pais_produccion}</td>
                            <td>${movie.calificacion_IMDB}</td>
                            <td>${movie.sinopsis}</td>
                        </tr>
                    `;
                });
            });
        };

        // Cargar películas al cargar la página
        loadMovies();
    </script>
</body>
</html>
